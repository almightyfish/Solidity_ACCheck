# æ™ºèƒ½åˆçº¦è®¿é—®æ§åˆ¶æ¼æ´æ£€æµ‹å·¥å…· - é¡¹ç›®ç»“æ„

## ğŸ“ ç›®å½•ç»“æ„

```
bytecode_analysis/
â”œâ”€â”€ core/                           # æ ¸å¿ƒåˆ†ææ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ analyzer.py                 # ä¸»åˆ†æå™¨ï¼ˆä¸€ä½“åŒ–å…¥å£ï¼‰
â”‚   â”œâ”€â”€ bytecode_analyzer.py        # å­—èŠ‚ç åˆ†æå™¨
â”‚   â”œâ”€â”€ cfg_builder.py              # æ§åˆ¶æµå›¾æ„å»ºå™¨
â”‚   â”œâ”€â”€ compiler.py                 # Solidityç¼–è¯‘å™¨å°è£…
â”‚   â”œâ”€â”€ dataflow_analyzer.py        # æ•°æ®æµåˆ†æå™¨
â”‚   â”œâ”€â”€ report.py                   # æŠ¥å‘Šç”Ÿæˆå™¨
â”‚   â”œâ”€â”€ source_mapper.py            # æºç æ˜ å°„å™¨ï¼ˆæ ¸å¿ƒæ£€æµ‹é€»è¾‘ï¼‰
â”‚   â”œâ”€â”€ storage_analyzer.py         # å­˜å‚¨æ§½ä½åˆ†æå™¨
â”‚   â”œâ”€â”€ taint_analyzer.py           # æ±¡ç‚¹åˆ†æå™¨
â”‚   â””â”€â”€ variable_finder.py          # å˜é‡æŸ¥æ‰¾å™¨
â”‚
â”œâ”€â”€ utils/                          # å·¥å…·æ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ opcode.py                   # EVMæ“ä½œç å®šä¹‰
â”‚   â””â”€â”€ colors.py                   # ç»ˆç«¯é¢œè‰²è¾“å‡º
â”‚
â”œâ”€â”€ examples/                       # ç¤ºä¾‹åˆçº¦å’Œæµ‹è¯•
â”‚   â””â”€â”€ test_contracts/
â”‚
â”œâ”€â”€ test_*.py                       # å„ç§æµ‹è¯•è„šæœ¬
â”œâ”€â”€ README_ä½¿ç”¨æŒ‡å—.md              # ä½¿ç”¨æŒ‡å—ï¼ˆæœ¬æ–‡æ¡£çš„å…„å¼Ÿæ–‡æ¡£ï¼‰
â”œâ”€â”€ README_é¡¹ç›®ç»“æ„.md              # é¡¹ç›®ç»“æ„ï¼ˆæœ¬æ–‡æ¡£ï¼‰
â””â”€â”€ README_å¤„ç†é€»è¾‘.md              # å¤„ç†é€»è¾‘å’Œç®—æ³•
```

---

## ğŸ§© æ ¸å¿ƒæ¨¡å—è¯´æ˜

### 1. `analyzer.py` - ä¸»åˆ†æå™¨

**ä½œç”¨**ï¼šä¸€ä½“åŒ–åˆ†æå…¥å£ï¼Œåè°ƒæ‰€æœ‰å­æ¨¡å—

**ä¸»è¦ç±»**ï¼š
```python
class AllInOneAnalyzer:
    """ä¸€ä½“åŒ–æ™ºèƒ½åˆçº¦åˆ†æå™¨"""
    
    def __init__(self, solc_version, key_variables, contract_path, output_dir):
        """åˆå§‹åŒ–åˆ†æå™¨"""
        
    def run(self) -> bool:
        """è¿è¡Œå®Œæ•´çš„åˆ†ææµç¨‹"""
        # 1. ç¼–è¯‘åˆçº¦
        # 2. åˆ†æå­—èŠ‚ç 
        # 3. æ„å»ºCFG
        # 4. åˆ†æå­˜å‚¨
        # 5. æ•°æ®æµåˆ†æ
        # 6. æ±¡ç‚¹åˆ†æ
        # 7. æºç æ˜ å°„
        # 8. ç”ŸæˆæŠ¥å‘Š
```

**å…³é”®æ–¹æ³•**ï¼š
- `run()`: æ‰§è¡Œå®Œæ•´åˆ†ææµç¨‹
- `_setup_environment()`: ç¯å¢ƒåˆå§‹åŒ–
- `_validate_inputs()`: è¾“å…¥éªŒè¯

---

### 2. `compiler.py` - ç¼–è¯‘å™¨å°è£…

**ä½œç”¨**ï¼šç®¡ç†Solidityç¼–è¯‘å™¨ï¼Œç”Ÿæˆå­—èŠ‚ç å’Œæ±‡ç¼–

**åŠŸèƒ½**ï¼š
- åˆ‡æ¢solcç‰ˆæœ¬
- ç¼–è¯‘Solidityæºç 
- ç”Ÿæˆbytecodeå’Œruntime bytecode
- ç”Ÿæˆæ±‡ç¼–ä»£ç 

**ç¤ºä¾‹**ï¼š
```python
compiler = SolidityCompiler(
    solc_version='0.4.24',
    contract_path='contract.sol',
    output_dir='./output'
)
result = compiler.compile()
```

---

### 3. `bytecode_analyzer.py` - å­—èŠ‚ç åˆ†æ

**ä½œç”¨**ï¼šè§£æå’Œåæ±‡ç¼–EVMå­—èŠ‚ç 

**ä¸»è¦åŠŸèƒ½**ï¼š
- å­—èŠ‚ç åæ±‡ç¼–
- è¯†åˆ«åŸºæœ¬å—
- æå–è·³è½¬ç›®æ ‡
- è¯†åˆ«å‡½æ•°é€‰æ‹©å™¨

**è¾“å‡º**ï¼šæŒ‡ä»¤åºåˆ—ã€åŸºæœ¬å—åˆ—è¡¨

---

### 4. `cfg_builder.py` - æ§åˆ¶æµå›¾æ„å»º

**ä½œç”¨**ï¼šæ„å»ºç¨‹åºçš„æ§åˆ¶æµå›¾ï¼ˆCFGï¼‰

**æ•°æ®ç»“æ„**ï¼š
```python
class BasicBlock:
    id: int              # åŸºæœ¬å—ID
    instructions: List   # æŒ‡ä»¤åˆ—è¡¨
    successors: List     # åç»§åŸºæœ¬å—
    predecessors: List   # å‰é©±åŸºæœ¬å—
```

**ç®—æ³•**ï¼š
- è¯†åˆ«åŸºæœ¬å—è¾¹ç•Œ
- å»ºç«‹å—é—´è·³è½¬å…³ç³»
- æ„å»ºå®Œæ•´CFG

---

### 5. `storage_analyzer.py` - å­˜å‚¨åˆ†æ

**ä½œç”¨**ï¼šåˆ†ææ™ºèƒ½åˆçº¦çš„å­˜å‚¨å¸ƒå±€

**ä¸»è¦åŠŸèƒ½**ï¼š
- è¯†åˆ«çŠ¶æ€å˜é‡
- è®¡ç®—å­˜å‚¨æ§½ä½
- æ˜ å°„å˜é‡åˆ°æ§½ä½
- å¤„ç†å¤æ‚ç±»å‹ï¼ˆmappingã€æ•°ç»„ç­‰ï¼‰

**ç¤ºä¾‹è¾“å‡º**ï¼š
```json
{
  "owner": {
    "slot": 0,
    "type": "address"
  },
  "totalSupply": {
    "slot": 1,
    "type": "uint256"
  }
}
```

---

### 6. `dataflow_analyzer.py` - æ•°æ®æµåˆ†æ

**ä½œç”¨**ï¼šè¿½è¸ªæ•°æ®åœ¨ç¨‹åºä¸­çš„æµåŠ¨

**åˆ†æç±»å‹**ï¼š
- å®šä¹‰-ä½¿ç”¨åˆ†æ
- æ´»è·ƒå˜é‡åˆ†æ
- åˆ°è¾¾å®šä¹‰åˆ†æ

**åº”ç”¨**ï¼š
- è¯†åˆ«å˜é‡ä¾èµ–å…³ç³»
- è¿½è¸ªæ±¡ç‚¹ä¼ æ’­è·¯å¾„
- è¾…åŠ©æ¼æ´æ£€æµ‹

---

### 7. `taint_analyzer.py` - æ±¡ç‚¹åˆ†æ

**ä½œç”¨**ï¼šè¿½è¸ªä¸å¯ä¿¡æ•°æ®ï¼ˆæ±¡ç‚¹ï¼‰çš„ä¼ æ’­

**æ ¸å¿ƒæ¦‚å¿µ**ï¼š
- **æ±¡ç‚¹æºï¼ˆSourceï¼‰**ï¼šä¸å¯ä¿¡è¾“å…¥ï¼ˆå¦‚`CALLDATALOAD`ï¼‰
- **æ±¡ç‚¹ä¼ æ’­**ï¼šæ±¡ç‚¹æ•°æ®çš„è®¡ç®—å’Œèµ‹å€¼
- **æ±¡ç‚¹æ±‡ï¼ˆSinkï¼‰**ï¼šå…³é”®å˜é‡å†™å…¥ï¼ˆå¦‚`SSTORE`ï¼‰

**ç®—æ³•**ï¼š
1. æ ‡è®°æ±¡ç‚¹æº
2. è¿½è¸ªæ±¡ç‚¹ä¼ æ’­
3. æ£€æµ‹æ±¡ç‚¹åˆ°è¾¾å…³é”®æ±‡ç‚¹
4. åˆ†æè·¯å¾„æ¡ä»¶

**è¾“å‡º**ï¼š
```json
{
  "has_taint": true,
  "taint_paths": [
    {
      "source": "CALLDATALOAD at offset 100",
      "sink": "SSTORE slot 0",
      "path": ["Block1", "Block2", "Block3"],
      "has_condition": false
    }
  ]
}
```

---

### 8. `source_mapper.py` - æºç æ˜ å°„å™¨ â­

**ä½œç”¨**ï¼šå°†å­—èŠ‚ç åˆ†æç»“æœæ˜ å°„å›æºç ï¼Œæ ¸å¿ƒæ£€æµ‹é€»è¾‘æ‰€åœ¨

**æ ¸å¿ƒåŠŸèƒ½**ï¼š

#### 8.1 å˜é‡ä½¿ç”¨è¯†åˆ«
```python
def _find_variable_usages(self, var_name: str) -> List[Dict]:
    """åœ¨æºç ä¸­æŸ¥æ‰¾å˜é‡çš„æ‰€æœ‰ä½¿ç”¨ä½ç½®"""
    # è¿”å›ï¼šè¡Œå·ã€ä»£ç ã€æ“ä½œç±»å‹ï¼ˆread/writeï¼‰ã€æ‰€å±å‡½æ•°
```

#### 8.2 æ„é€ å‡½æ•°è¯†åˆ«
```python
def _load_and_parse_source(self):
    """è§£ææºç ï¼Œè¯†åˆ«å‡½æ•°å’Œæ„é€ å‡½æ•°"""
    # è¯†åˆ« constructor() å’Œ function ContractName()
    # æ”¯æŒå¤šåˆçº¦æ–‡ä»¶
```

#### 8.3 è®¿é—®æ§åˆ¶æ£€æŸ¥
```python
def _check_public_function_has_access_control(self, func_name: str) -> Tuple[bool, str]:
    """æ£€æŸ¥å‡½æ•°æ˜¯å¦æœ‰è®¿é—®æ§åˆ¶"""
    # æ£€æŸ¥modifierã€visibilityç­‰
    # è¿”å›ï¼š(æœ‰æ— è®¿é—®æ§åˆ¶, åŸå› )
```

#### 8.4 æ¡ä»¶åˆ¤æ–­æ£€æŸ¥
```python
def _check_source_has_condition(self, usage: Dict) -> bool:
    """æ£€æŸ¥æ“ä½œæ˜¯å¦æœ‰æ¡ä»¶ä¿æŠ¤"""
    # æ£€æŸ¥ require/assert/if è¯­å¥
    # ä¸ä»…é™äºè®¿é—®æ§åˆ¶ï¼Œä»»ä½•æ¡ä»¶éƒ½ç®—
```

#### 8.5 æ•æ„Ÿå‡½æ•°æ£€æµ‹
```python
def _check_sensitive_functions(self) -> List[Dict]:
    """æ£€æµ‹æ•æ„Ÿå‡½æ•°è°ƒç”¨"""
    # æ£€æµ‹ selfdestruct, delegatecall, suicide, callcode
    # æ£€æŸ¥æ˜¯å¦æœ‰è®¿é—®æ§åˆ¶
```

#### 8.6 é£é™©åˆ†çº§é€»è¾‘
```python
def map_to_source(self, bytecode_results: List[Dict], taint_results: List[Dict]) -> List[Dict]:
    """æ ¸å¿ƒæ˜ å°„é€»è¾‘"""
    
    # è¿‡æ»¤é“¾ï¼š
    # 1. è·³è¿‡å˜é‡å£°æ˜ï¼ˆtype == 'declaration'ï¼‰
    # 2. è·³è¿‡æ„é€ å‡½æ•°æ“ä½œï¼ˆis_constructor == Trueï¼‰
    # 3. æ£€æŸ¥è®¿é—®æ§åˆ¶ï¼ˆmodifier/visibilityï¼‰
    # 4. æ£€æŸ¥æ¡ä»¶åˆ¤æ–­ï¼ˆrequire/if/assertï¼‰
    
    # é£é™©åˆ†çº§ï¼š
    # - æœ‰è®¿é—®æ§åˆ¶ â†’ å®‰å…¨ï¼ˆä¸æ ‡è®°ï¼‰
    # - æœ‰æ¡ä»¶åˆ¤æ–­ â†’ å¯ç–‘ï¼ˆéœ€å®¡æŸ¥ï¼‰
    # - æ— ä»»ä½•ä¿æŠ¤ â†’ å±é™©ï¼ˆéœ€ä¿®å¤ï¼‰
```

---

### 9. `report.py` - æŠ¥å‘Šç”Ÿæˆ

**ä½œç”¨**ï¼šç”Ÿæˆåˆ†ææŠ¥å‘Šï¼ˆJSON + HTML + ç»ˆç«¯ï¼‰

**è¾“å‡ºæ ¼å¼**ï¼š

#### 9.1 JSONæŠ¥å‘Š
```json
{
  "contract_path": "...",
  "summary": {
    "total_variables": 5,
    "vulnerable_count": 2,
    "dangerous_paths_total": 3,
    "suspicious_paths_total": 2
  },
  "results": [...]
}
```

#### 9.2 HTMLæŠ¥å‘Š
- å¯è§†åŒ–å±•ç¤º
- ä»£ç é«˜äº®
- é£é™©ä½ç½®æ ‡æ³¨

#### 9.3 ç»ˆç«¯æŠ¥å‘Š
- å½©è‰²è¾“å‡º
- åˆ†çº§æ˜¾ç¤º
- å®æ—¶åé¦ˆ

---

## ğŸ”„ æ•°æ®æµè½¬

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Solidityæºç     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¼–è¯‘å™¨ (solc)   â”‚  â†’ bytecode, runtime-bytecode, asm
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å­—èŠ‚ç åˆ†æ      â”‚  â†’ æŒ‡ä»¤åºåˆ—
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CFGæ„å»º         â”‚  â†’ åŸºæœ¬å—ã€è·³è½¬å…³ç³»
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å­˜å‚¨åˆ†æ        â”‚  â†’ å˜é‡â†’æ§½ä½æ˜ å°„
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ•°æ®æµåˆ†æ      â”‚  â†’ å˜é‡ä¾èµ–å…³ç³»
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ±¡ç‚¹åˆ†æ        â”‚  â†’ æ±¡ç‚¹ä¼ æ’­è·¯å¾„
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æºç æ˜ å°„ â­      â”‚  â†’ é£é™©ä½ç½®å®šä½
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  ï¼ˆæ ¸å¿ƒæ£€æµ‹é€»è¾‘ï¼‰
         â”‚
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æŠ¥å‘Šç”Ÿæˆ        â”‚  â†’ JSON + HTML + ç»ˆç«¯
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ æ ¸å¿ƒæ£€æµ‹æµç¨‹

### æ±¡ç‚¹åˆ†æè·¯å¾„

```
1. è¯†åˆ«æ±¡ç‚¹æº
   â””â”€> CALLDATALOAD, CALLVALUE ç­‰

2. è¿½è¸ªæ±¡ç‚¹ä¼ æ’­
   â””â”€> é€šè¿‡ CFG è¿½è¸ªæ•°æ®æµ

3. æ£€æµ‹åˆ°è¾¾æ±‡ç‚¹
   â””â”€> SSTORE å†™å…¥å…³é”®å˜é‡

4. åˆ†æè·¯å¾„æ¡ä»¶
   â””â”€> æ˜¯å¦æœ‰ JUMPIï¼ˆæ¡ä»¶è·³è½¬ï¼‰

5. æ˜ å°„åˆ°æºç 
   â””â”€> å®šä½å…·ä½“ä»£ç è¡Œ
```

### è¡¥å……æ£€æµ‹è·¯å¾„

```
1. è¯†åˆ«publicå‡½æ•°
   â””â”€> æ—  modifier ä¿æŠ¤

2. æ£€æŸ¥å†™å…¥æ“ä½œ
   â””â”€> è·³è¿‡ declaration å’Œ constructor

3. æ£€æŸ¥æ¡ä»¶åˆ¤æ–­
   â””â”€> require/assert/if è¯­å¥

4. é£é™©åˆ†çº§
   â”œâ”€> æœ‰æ¡ä»¶ â†’ å¯ç–‘
   â””â”€> æ— æ¡ä»¶ â†’ å±é™©
```

---

## ğŸ› ï¸ å…³é”®ç®—æ³•

### 1. å­˜å‚¨æ§½ä½è®¡ç®—

```python
def calculate_slot(var_index: int, var_type: str) -> int:
    """è®¡ç®—å˜é‡çš„å­˜å‚¨æ§½ä½"""
    if var_type in ['uint256', 'address', 'bool']:
        return var_index
    elif var_type == 'mapping':
        # mapping ä½¿ç”¨å“ˆå¸Œè®¡ç®—
        return keccak256(key + slot)
    elif var_type == 'array':
        # åŠ¨æ€æ•°ç»„
        return keccak256(slot) + index
```

### 2. æ±¡ç‚¹ä¼ æ’­è§„åˆ™

```python
def propagate_taint(instruction, taint_set):
    """æ±¡ç‚¹ä¼ æ’­"""
    if instruction.opcode in ['ADD', 'SUB', 'MUL', 'DIV']:
        # ç®—æœ¯è¿ç®—ï¼šä»»ä¸€æ“ä½œæ•°æœ‰æ±¡ç‚¹ï¼Œç»“æœå°±æœ‰æ±¡ç‚¹
        if instruction.operand1 in taint_set or instruction.operand2 in taint_set:
            taint_set.add(instruction.result)
    
    elif instruction.opcode == 'SLOAD':
        # ä»å­˜å‚¨è¯»å–ï¼šç»“æœå¯èƒ½æœ‰æ±¡ç‚¹
        taint_set.add(instruction.result)
    
    elif instruction.opcode == 'SSTORE':
        # å†™å…¥å­˜å‚¨ï¼šå¦‚æœå€¼æœ‰æ±¡ç‚¹ï¼Œè®°å½•ä¸ºæ±¡ç‚¹æ±‡ç‚¹
        if instruction.value in taint_set:
            record_taint_sink(instruction)
```

### 3. è·¯å¾„æ¡ä»¶æ£€æµ‹

```python
def has_path_condition(path: List[Block]) -> bool:
    """æ£€æŸ¥è·¯å¾„æ˜¯å¦æœ‰æ¡ä»¶åˆ¤æ–­"""
    for block in path:
        # æ£€æŸ¥æ˜¯å¦æœ‰æ¡ä»¶è·³è½¬ï¼ˆJUMPIï¼‰
        if any(instr.opcode == 'JUMPI' for instr in block.instructions):
            return True
    return False
```

---

## ğŸ“Š è¾“å‡ºæ–‡ä»¶ç»“æ„

```
output/
â”œâ”€â”€ intermediate/                   # ä¸­é—´ç»“æœ
â”‚   â”œâ”€â”€ bytecode_analysis.json     # å­—èŠ‚ç åˆ†æç»“æœ
â”‚   â”œâ”€â”€ cfg.json                   # æ§åˆ¶æµå›¾
â”‚   â”œâ”€â”€ storage_mapping.json       # å­˜å‚¨æ˜ å°„
â”‚   â”œâ”€â”€ dataflow.json              # æ•°æ®æµåˆ†æ
â”‚   â”œâ”€â”€ taint_analysis.jsonl       # æ±¡ç‚¹åˆ†æç»“æœ
â”‚   â””â”€â”€ source_mapping.json        # æºç æ˜ å°„ç»“æœ
â”‚
â”œâ”€â”€ ContractName.bin               # å­—èŠ‚ç 
â”œâ”€â”€ ContractName.bin-runtime       # è¿è¡Œæ—¶å­—èŠ‚ç 
â”œâ”€â”€ ContractName.evm               # æ±‡ç¼–ä»£ç 
â”œâ”€â”€ final_report.json              # æœ€ç»ˆJSONæŠ¥å‘Š
â””â”€â”€ final_report.html              # æœ€ç»ˆHTMLæŠ¥å‘Š
```

---

## ğŸ§ª æµ‹è¯•æ–‡ä»¶è¯´æ˜

- `test_miboodle.py` - æµ‹è¯•requireè¯†åˆ«ä¿®å¤
- `test_declaration_fix.py` - æµ‹è¯•å˜é‡å£°æ˜è¿‡æ»¤
- `test_ethflip.py` - æµ‹è¯•å¤šåˆçº¦æ„é€ å‡½æ•°
- `test_comprehensive_fixes.py` - ç»¼åˆæµ‹è¯•
- `test_uec_token.py` - æµ‹è¯•æ¡ä»¶åˆ¤æ–­æ”¹è¿›

---

## ğŸ”§ é…ç½®å’Œæ‰©å±•

### æ·»åŠ æ–°çš„æ±¡ç‚¹æº

ç¼–è¾‘ `taint_analyzer.py`:
```python
TAINT_SOURCES = [
    'CALLDATALOAD',   # å‡½æ•°å‚æ•°
    'CALLVALUE',      # msg.value
    'CALLER',         # msg.sender
    'ORIGIN',         # tx.origin
    # æ·»åŠ æ–°çš„æ±¡ç‚¹æº
    'GASPRICE',       # tx.gasprice
]
```

### æ·»åŠ æ–°çš„æ•æ„Ÿæ“ä½œ

ç¼–è¾‘ `source_mapper.py`:
```python
sensitive_keywords = {
    'selfdestruct': 'åˆçº¦è‡ªæ¯',
    'delegatecall': 'å§”æ‰˜è°ƒç”¨',
    'suicide': 'åˆçº¦è‡ªæ¯ï¼ˆå·²å¼ƒç”¨ï¼‰',
    'callcode': 'ä»£ç è°ƒç”¨ï¼ˆå·²å¼ƒç”¨ï¼‰',
    # æ·»åŠ æ–°çš„æ•æ„Ÿæ“ä½œ
    'transfer': 'è½¬è´¦æ“ä½œ',
    'send': 'å‘é€ä»¥å¤ªå¸',
}
```

---

## ğŸ“š ä¾èµ–å…³ç³»

```
analyzer.py
â”œâ”€â”€ compiler.py
â”œâ”€â”€ bytecode_analyzer.py
â”‚   â””â”€â”€ opcode.py
â”œâ”€â”€ cfg_builder.py
â”‚   â””â”€â”€ bytecode_analyzer.py
â”œâ”€â”€ storage_analyzer.py
â”œâ”€â”€ dataflow_analyzer.py
â”‚   â””â”€â”€ cfg_builder.py
â”œâ”€â”€ taint_analyzer.py
â”‚   â”œâ”€â”€ cfg_builder.py
â”‚   â””â”€â”€ dataflow_analyzer.py
â”œâ”€â”€ variable_finder.py
â”œâ”€â”€ source_mapper.py â­
â”‚   â”œâ”€â”€ variable_finder.py
â”‚   â””â”€â”€ taint_analyzer.py
â””â”€â”€ report.py
    â””â”€â”€ colors.py
```

---

## ğŸ“ æ ¸å¿ƒè®¾è®¡åŸåˆ™

1. **æ¨¡å—åŒ–**ï¼šæ¯ä¸ªæ¨¡å—èŒè´£å•ä¸€ï¼Œä¾¿äºç»´æŠ¤
2. **å¯æ‰©å±•**ï¼šæ˜“äºæ·»åŠ æ–°çš„æ£€æµ‹è§„åˆ™
3. **å¯æµ‹è¯•**ï¼šæ¯ä¸ªæ¨¡å—éƒ½æœ‰å¯¹åº”çš„æµ‹è¯•
4. **é«˜æ•ˆç‡**ï¼šä¼˜åŒ–ç®—æ³•ï¼Œæ”¯æŒå¤§å‹åˆçº¦
5. **å‡†ç¡®æ€§**ï¼šå¤šé‡æ£€æµ‹ï¼Œå‡å°‘è¯¯æŠ¥å’Œæ¼æŠ¥

---

**ç‰ˆæœ¬**: v2.8  
**æ›´æ–°æ—¥æœŸ**: 2025å¹´10æœˆ7æ—¥

ğŸ“– **ç›¸å…³æ–‡æ¡£**ï¼š
- ä½¿ç”¨æŒ‡å—ï¼š`README_ä½¿ç”¨æŒ‡å—.md`
- å¤„ç†é€»è¾‘ï¼š`README_å¤„ç†é€»è¾‘.md`

